<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1;maximum-scale=1.0; user-scalable=0;">
		<title>URGENCE MOBILE | Appel Urgences</title>
		<!--CSS-->
		<link href="css/styles.css?v=1.2" rel="stylesheet">
		<link href="css/queries.css?v=1.2" rel="stylesheet">
		<link href="css/bootstrap.css" rel="stylesheet">
		<link href="css/font-awesome.min.css" rel="stylesheet" type="text/css">
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
		<!--JS & JQuery-->
		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script>
			$(document).ready(function(){
											   
				//When you click on a link with class of poplight and the href starts with a # 
				$('a.poplight[href^=#]').click(function() {
					var popID = $(this).attr('rel'); //Get Popup Name
					var popURL = $(this).attr('href'); //Get Popup href to define size
							
					//Pull Query & Variables from href URL
					var query= popURL.split('?');
					var dim= query[1].split('&');
					var popNumEmergency = dim[0].split('=')[1]; //Gets the first query string value
					var popEmergency = dim[1].split('=')[1]; //Gets the first query string value

					//Fade in the Popup and add close button
					$('#' + popID).fadeIn().prepend('<a href="#" class="close">x</a>');
					
					//Define margin for center alignment (vertical + horizontal) - we add 80 to the height/width to accomodate for the padding + border width defined in the css
					var popMargTop = ($('#' + popID).height() + 40) / 2;
					var popMargLeft = ($('#' + popID).width() + 40) / 2;
					
					//Apply Margin to Popup
					$('#' + popID).css({ 
						'margin-top' : -popMargTop,
						'margin-left' : -popMargLeft
					});
					
					$('.procedures h4').html(popEmergency + ' - ' + popNumEmergency);
					$('.btn-call span').html(popNumEmergency);
					$('.btn-call').attr('href','tel:'+popNumEmergency);
					
					//Fade in Background
					$('body').append('<div id="fade"></div>'); //Add the fade layer to bottom of the body tag.
					$('#fade').css({'filter' : 'alpha(opacity=80)'}).fadeIn(); //Fade in the fade layer 
					
					return false;
				});
				
				
				//Close Popups and Fade Layer
				$('a.close, #fade').live('click', function() { //When clicking on the close or fade layer...
					$('#fade , .popup_block').fadeOut(function() {
						$('#fade, a.close').remove();
				}); //fade them both out
				$(".geolocation").slideToggle();
				
					return false;
				});
			});
		</script>
		
	</head>
	
	<body>
		<header class="header">
			<nav class="navbar navbar-static-top" role="navigation">
				<div class="navbar-main">
					<!-- Sidebar toggle button -->
					<a href="#" class="navbar-btn sidebar-toggle" data-toggle="offcanvas" role="button">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<!-- App Name Logo -->
					<a href="home.html" class="logo">
					<!-- Add the class icon to your logo image or logo icon to add the margining -->
						URGENCE<br><span>MOBIL<span class="no_spacing">E</span></span>
					</a>
				</div>
				<div class="navbar-container">
                    <ul class="nav navbar-nav">
                        <!-- Home -->
                        <li>
                            <a href="home.html">
                                <i class="fa fa-home"></i>
                            </a>
                        </li>
                        <!-- Profile -->
                        <li>
                            <a href="#">
                                <i class="fa fa-user"></i>
                            </a>
                        </li>
                        <!-- Settings -->
                        <li>
                            <a href="#">
                                <i class="fa fa-cog"></i>
                            </a>
						</li>
					</ul>
                </div>
				<div class="navbar-bottom-border"></div>
				<script>
					$(".navbar-btn").click(function(){
						$(".navbar-container").slideToggle("slow");
					});
				</script>
			</nav>			
		</header>
		<section class="main">
			<div class="container">
				<div class="row emergency-numbers">
					<!-- Main Menu -->
					<div class="col-xs-6 col-md-4 square">
						<!-- square box -->
						<div class="content">
							<a href="#?num=198&emrg=Protection Civile" rel="call_emergency" class="square-link poplight">
								<div class="table">
									<div class="table-cell numbers">
											Protection Civile
											<img src="img/urg-icon-1.png"/>
											198
									</div>
								</div>
							</a>
						</div>
					</div>
					<div class="col-xs-6 col-md-4 square">
						<!-- square box -->
						<div class="content">
							<a href="#?num=190&emrg=S.A.M.U." rel="call_emergency" class="square-link poplight">
								<div class="table">
									<div class="table-cell numbers">
											S.A.M.U.
											<img src="img/urg-icon-2.png"/>
											190
									</div>
								</div>
							</a>
						</div>
					</div>
					<div class="col-xs-6 col-md-4 square">
						<!-- square box -->
						<div class="content">
							<a href="#?num=197&emrg=Police" rel="call_emergency" class="square-link poplight">
								<div class="table">
									<div class="table-cell numbers">
											Police
											<img src="img/urg-icon-3.png"/>
											197
									</div>
								</div>
							</a>
						</div>
					</div>
					<div class="col-xs-6 col-md-4 square">
						<!-- square box -->
						<div class="content">
							<a href="#?num=193&emrg=Garde Nationale" rel="call_emergency" class="square-link poplight">
								<div class="table">
									<div class="table-cell numbers">
											Garde Nationale
											<img src="img/urg-icon-4.png"/>
											193
									</div>
								</div>
							</a>
						</div>
					</div>
				
					<div id="call_emergency" class="popup_block">
						<div class="main_block">
							<div class="procedures">
								<h4></h4>
								&nbsp;Décrire la situation aux services d'urgence  en précisant:</br></br>
								&nbsp;- le numéro du téléphone d'où vous appelez</br>
								&nbsp;- la nature du problème: maladie, accident...</br>
								&nbsp;- les risques éventuels</br>
								&nbsp;- votre localisation précise</br></br>
								&nbsp;Après, répond aux questions et attend les instructions avant de raccrocher.</br>
								&nbsp;Vous devez suivre les conseils données par les secours.</br>
							</div>
							<div id="geo-box" class="geolocation">
							</div>
						</div>
						<div class="buttons_block">
							<div class="col-xs-6 box">
								<!-- square box -->
								<div class="content">
									<a href="#" id="geolocation" class="box-link">
										<div class="table">
											<div class="table-cell">
													Vous localiser
											</div>
										</div>
									</a>
								</div>
							</div>
							<div class="col-xs-6 box">
								<!-- square box -->
								<div class="content">
									<a href="#" class="box-link btn-call">
										<div class="table">
											<div class="table-cell">
												<img src="img/btn-call.png"><span></span>
											</div>
										</div>
									</a>
								</div>
							</div>
							<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
							<script>
								geoclick = 0;
								$("#geolocation").click(function(){ 
									if(geoclick==0){ getLocation();}
									geoclick++;
								});
								$("#geolocation").click(function(){
									$(".geolocation").slideToggle();
								}, function(){
									$(".geolocation").slideToggle();
								});
								
								function getLocation()
								  {
								  if (navigator.geolocation)
									{
									navigator.geolocation.getCurrentPosition(showPosition,showError);
									}
								  else{alert("Geolocation is not supported by this browser.");}
								  }

								function showPosition(position)
								  {
								  lat=position.coords.latitude;
								  lon=position.coords.longitude;
								  latlon=new google.maps.LatLng(lat, lon)
								  mapholder=document.getElementById('geo-box');

								  var myOptions={
								  center:latlon,zoom:14,
								  mapTypeId:google.maps.MapTypeId.ROADMAP,
								  mapTypeControl:false,
								  navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}
								  };
								  var map=new google.maps.Map(document.getElementById("geo-box"),myOptions);
								  var marker=new google.maps.Marker({position:latlon,map:map,title:"You are here!",animation: google.maps.Animation.DROP/*bounce animation*/});
								  //Content structure of info Window for the Markers
								var contentString = $('<div class="marker-info-win" style="width: 110%;">'+
								'<div class="marker-inner-win"><span class="info-content"><b>'+
								'<u>Longitude</u>: '+ lon.toFixed(7) +'</br>'+
								'<u>Latitude</u>: '+ lat.toFixed(7) +
								'</b></span>'+
								'</div></div>');
									
								//Create an infoWindow
								var infowindow = new google.maps.InfoWindow();
								
								//set the content of infoWindow
								infowindow.setContent(contentString[0]);
								
								//add click event listener to marker which will open infoWindow          
								google.maps.event.addListener(marker, 'click', function() {
									infowindow.open(map,marker); // click on marker opens info window 
								});
								  }

								function showError(error)
								  {
								  switch(error.code) 
									{
									case error.PERMISSION_DENIED:
									  alert("User denied the request for Geolocation.")
									  break;
									case error.POSITION_UNAVAILABLE:
									  alert("Location information is unavailable.")
									  break;
									case error.TIMEOUT:
									  alert("The request to get user location timed out.")
									  break;
									case error.UNKNOWN_ERROR:
									  alert("An unknown error occurred.")
									  break;
									}
								  }
							</script>
						</div>
					</div>
				</div>
			</div>
		</section>
	<body>
</html>